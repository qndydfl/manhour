{% extends "manning/base/base.html" %}
{% load static %}

{% block title %}데이터 등록 | Manning System{% endblock title %}

{% block css %}
    <link rel="stylesheet" href="{% static 'css/paste_data.css' %}">    
{% endblock css %}

{% block js %}
    <script>
        // ✅ Django 템플릿에서만 렌더링 가능
        const PASTE_DATA_POST_URL = "{% url 'paste_data' %}";
        const MASTER_DATA_LIST_URL = "{% url 'master_data_list' %}";
      </script>
    <script defer src="{% static 'js/paste_data.js' %}"></script>
{% endblock js %}

{% block navsize %}style="max-width: 1000px;"{% endblock navsize %}
{% block navhome %}href="{% url 'index' %}"{% endblock navhome %} 
{% block navname %}<span>홈 페이지</span>{% endblock navname %} 
{% block navreturn %}
<a
    href="{% url 'index' %}"
    class="btn btn-outline-secondary btn-sm text-light border-secondary"
>
    <i class="bi bi-clock-history"></i>
    <span class="d-none d-md-inline">되돌아가기</span>
</a>
{% endblock navreturn %}

{% block content %}
<div class="container" style="max-width: 1000px; padding-top: 100px;"> 
    <div class="d-flex flex-wrap justify-content-between align-items-center mb-4 gap-3" data-aos="fade-down">
        <div class="d-flex align-items-center gap-3">            
            <h4 class="fw-bold m-0 text-dark">데이터 관리</h4>
        </div>
        <div>
            <a href="{% url 'master_data_list' %}" class="btn btn-outline-primary rounded-pill px-4 fw-bold shadow-sm">
                <i class="bi bi-list-ul me-1"></i> 데이터 목록 관리
            </a>
        </div>
    </div>

    <div class="card border-0 shadow-lg rounded-4 overflow-hidden" data-aos="fade-up">
        <div class="card-header bg-white border-0 pt-4 px-4 px-md-5">
            <div class="d-flex align-items-center gap-3">
                <div class="bg-soft-primary p-3 rounded-circle" style="background-color: rgba(13, 110, 253, 0.1);">
                    <i class="bi bi-magic fs-3 text-primary"></i>
                </div>
                <div>
                    <h5 class="fw-bold mb-1">데이터 스마트 일괄 등록</h5>
                    <p class="text-muted small mb-0">
                        엑셀 데이터를 복사(Ctrl+C)한 후, <strong>표의 첫 번째 칸을 클릭하고 붙여넣기(Ctrl+V)</strong> 하세요.
                    </p>
                </div>
            </div>
        </div>

        <div class="card-body px-4 px-md-5 pb-5">
            
            <div class="instruction-box p-3 rounded-3 mb-4 bg-light border">
                <h6 class="fw-bold text-primary mb-2"><i class="bi bi-info-circle me-1"></i>데이터 순서 (엑셀 컬럼)</h6>
                <div class="d-flex flex-wrap gap-2 font-monospace small text-dark align-items-center">
                    <span class="badge bg-white text-dark border shadow-sm px-2 py-1">1. 기번 (HLxxxx)</span>
                    <i class="bi bi-arrow-right text-muted"></i>
                    <span class="badge bg-white text-dark border shadow-sm px-2 py-1">2. Work Order</span>
                    <i class="bi bi-arrow-right text-muted"></i>
                    <span class="badge bg-white text-dark border shadow-sm px-2 py-1">3. OP</span>
                    <i class="bi bi-arrow-right text-muted"></i>
                    <span class="badge bg-white text-dark border shadow-sm px-2 py-1">4. Description</span>
                    <i class="bi bi-arrow-right text-muted"></i>
                    <span class="badge bg-white text-dark border shadow-sm px-2 py-1">5. Work (M/H)</span>
                </div>
            </div>

            <form id="pasteForm">
                {% csrf_token %}
                
                <div class="table-responsive mb-4 border rounded-3">
                    <table class="table table-bordered text-center align-middle mb-0 smart-table" id="gridTable">
                        <thead>
                            <tr>
                                <th style="width: 15%">기번 (Gibun)</th>
                                <th style="width: 15%">Work Order</th>
                                <th style="width: 10%">OP</th>
                                <th style="width: 45%">설명 (Description)</th>
                                <th style="width: 15%">기준 M/H</th>
                            </tr>
                        </thead>
                        <tbody>
                            </tbody>
                    </table>
                </div>

                <div class="row g-3">
                    <div class="col-md-3">
                        <button type="button" onclick="addRow()" class="btn btn-light w-100 fw-bold border text-muted rounded-pill">
                            <i class="bi bi-plus-lg"></i> 줄 추가
                        </button>
                    </div>
                    <div class="col-md-3">
                        <a href="{% url 'index' %}" class="btn btn-light w-100 fw-bold text-secondary rounded-pill">
                            취소
                        </a>
                    </div>
                    <div class="col-md-6">
                        <button type="button" onclick="saveData()" class="btn btn-primary w-100 fw-bold rounded-pill shadow-sm">
                            <i class="bi bi-save me-1"></i> 데이터 저장하기
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock content %}
